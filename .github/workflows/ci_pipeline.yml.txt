# .github/workflows/ci_pipeline.yml

name: Test and Deploy Simulation (Variant 1) # –ù–∞–∑–≤–∞ –ø–∞–π–ø–ª–∞–π–Ω—É

on:
  push:
    branches: [ "main" ] # –ó–∞–ø—É—Å–∫–∞—î–º–æ –ø—Ä–∏ –ø—É—à—ñ –≤ –≥—ñ–ª–∫—É main
  pull_request:
    branches: [ "main" ] # –ó–∞–ø—É—Å–∫–∞—î–º–æ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ Pull Request —É main

jobs:
  # === –ö–†–û–ö 1: –ó–ê–ü–£–°–ö –¢–ï–°–¢–Ü–í ===
  test:
    runs-on: ubuntu-latest # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ GitHub
    steps:
    - name: ‚¨áÔ∏è Checkout code
      uses: actions/checkout@v4

    - name: üêç Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.x' # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –æ—Å—Ç–∞–Ω–Ω—é –≤–µ—Ä—Å—ñ—é Python 3

    - name: ‚öôÔ∏è Install dependencies (pytest)
      run: pip install -r requirements.txt

    - name: üöÄ Run tests (–ö—Ä–æ–∫ 1)
      id: run_tests
      run: pytest
      # –Ø–∫—â–æ —Ü–µ–π –∫—Ä–æ–∫ –ø–æ–≤–µ—Ä–Ω–µ –ø–æ–º–∏–ª–∫—É (—Ç–µ—Å—Ç–∏ –Ω–µ –ø—Ä–æ–π–¥—É—Ç—å), –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ (deploy) –ù–ï –ë–£–î–ï –∑–∞–ø—É—â–µ–Ω–∏–π.

  # === –ö–†–û–ö 2: –°–ò–ú–£–õ–Ø–¶–Ü–Ø –î–ï–ü–õ–û–Æ ===
  deploy_simulation:
    needs: test # –û–±–æ–≤'—è–∑–∫–æ–≤–∞ —É–º–æ–≤–∞: —Ü–µ–π –∫—Ä–æ–∫ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –õ–ò–®–ï –ü–Ü–°–õ–Ø —É—Å–ø—ñ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è job 'test'
    runs-on: ubuntu-latest
    steps:
    - name: ‚úÖ Check Test Status
      run: echo "–¢–µ—Å—Ç–∏ —É—Å–ø—ñ—à–Ω–æ –ø—Ä–æ–π—à–ª–∏, –ø—Ä–æ–¥–æ–≤–∂—É—î–º–æ..."

    - name: üì¢ Deployment Simulation (–ö—Ä–æ–∫ 2)
      run: echo "Deployed" # –°–∏–º—É–ª—è—Ü—ñ—è –¥–µ–ø–ª–æ—é: –≤–∏–≤—ñ–¥ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫ –≤–∏–º–∞–≥–∞—î –∑–∞–≤–¥–∞–Ω–Ω—è